\section{Extrema von Funktionen finden} \label{section:extrema_bivar}
\myul{\textbf{Stationäritätsbedingung:}} $\nabla f \stackrel{!}{=} \vec{0}$

\subsection{Extrema von Funktionen zweier Variablen finden}
\begin{enumerate}[itemsep=1ex]
    \item \textbf{Gradient von $f$ Null-setzten und kritische Stellen finden:}

    $\nabla f=
    \begin{pmatrix}
        f_x\\
        f_y
    \end{pmatrix} \stackrel{!}{=}
    \begin{pmatrix}
        0\\
        0
    \end{pmatrix}
    \, \, \, \, \, \,
    \Rightarrow 
    \begin{matrix}
        f_{x}=0\\
        f_{y}=0
    \end{matrix}
    \, \, \, \, \, \,
    \Rightarrow
    x_0 \text{ und } y_0 \text{ bestimmen}$

    \item \textbf{Zweite Partielle Ableitungen bestimmen:}
        
    \begin{tabular}{lll}
        $f_{xx} = \dots$ & $f_{xy} = f_{yx} = \dots$ & $f_{yy} = \dots$ \\
    \end{tabular}

    \item \textbf{Determinante $\Delta$ der Hesse-Matrix H bestimmen:}
    
    $\Delta = f_{xx}(x_0;y_0) \cdot f_{yy}(x_0;y_0) - \left(f_{xy}(x_0;y_0)\right)^2 $

    \item \textbf{Auswertung:}
    
    \begin{tabular}{lllcl}
        \hline
        $\Delta > 0$ &AND& $f_{xx}(x_0;y_0) < 0$ &$\Longrightarrow$& $\text{lokales Maximum}$\\
        \hline
        $\Delta > 0$ &AND& $f_{yy}(x_0;y_0) < 0$ &$\Longrightarrow$& $\text{lokales Maximum}$\\
        \hline
        $\Delta > 0$ &AND& $f_{xx}(x_0;y_0) > 0$ &$\Longrightarrow$& $\text{lokales Minimum}$\\
        \hline
        $\Delta > 0$ &AND& $f_{yy}(x_0;y_0) > 0$ &$\Longrightarrow$& $\text{lokales Minimum}$\\
        \hline
        $\Delta < 0$ &&&$\Longrightarrow$& $\text{Sattelpunkt}$\\
        \hline
        $\Delta = 0$ &&&?& $\text{Multi-variate-Taylor-logik ...}$\\
        \hline
    \end{tabular}

\end{enumerate}

\subsection{Extrema von Funktionen mehrerer Variablen finden}

\begin{enumerate}[itemsep=1ex]
    \item \textbf{Gradient von $f$ Null-setzten und kritische Stellen finden:}
    
    $\nabla f=
    \begin{pmatrix}
        f_x\\
        f_y\\
        \vdots \\
        f_t
    \end{pmatrix} \stackrel{!}{=}
    \begin{pmatrix}
        0\\
        0\\
        \vdots \\
        0
    \end{pmatrix}
    \quad \Rightarrow x_0$, $y_0$, $\ldots$, $t_0$ bestimmen
    
    \item \textbf{Zweite Partielle Ableitungen für Hesse-Matrix H bestimmen:}
    
    \begin{minipage}[t]{0.48\columnwidth}
        $\mathbf{H}=\begin{pmatrix}
            f_{xx}&f_{xy}&\ldots &f_{xt}\\
            f_{yx}&f_{yy}&\ldots&f_{yt}\\
            \vdots &\vdots &\ddots &\vdots \\
            f_{tx}&f_{ty}&\ldots&f_{tt}
        \end{pmatrix}$
    \end{minipage}\hfill
    \begin{minipage}[c]{0.48\columnwidth}
        \begin{itemize}
            \item Symmetrien beachten!
            \item Nicht doppelt rechnen!
            \item[] \textrightarrow\ $f_{xt} = f_{tx}$
        \end{itemize}
    \end{minipage}

    \item \textbf{Hesse-Matrix H mit gefundenen Stellen füllen:}

    $\mathbf{H}(x_0,y_0,\ldots t_0)=
    \begin{pmatrix}
        f_{xx}(x_0,y_0,\ldots t_0)&f_{xy}(x_0,y_0, \ldots t_0)&\cdots &f_{xt}(x_0,y_0,\ldots t_0)\\
        f_{yx}(x_0,y_0,\ldots t_0)&f_{yy}(x_0,y_0, \ldots t_0)&\cdots &f_{yt}(x_0,y_0,\ldots t_0)\\
        \vdots &\vdots &\ddots &\vdots \\
        f_{tx}(x_0,y_0,\ldots t_0)&f_{ty}(x_0,y_0, \ldots t_0)&\cdots &f_{tt}(x_0,y_0,\ldots t_0)\end{pmatrix}$

    \item \textbf{Eigenwerte $\lambda_i$ der Hesse-Matrix bestimmen:}

    $\text{det}\left(\mathbf{H}(x_0,y_0,\ldots t_0) - \lambda \cdot \mathbf{E}\right)  = 0$

    Nullstellen $\lambda_i$ finden $\rightarrow  $ Eigenwerte

    \medskip
    \myul{Zur Erinnerung:}\\
    $\mathbf{E} = \begin{pmatrix}
        1&0&\ldots &0\\
        0&1&\ldots&0\\
        \vdots &\vdots &\ddots &\vdots \\
        0&0&\ldots&1\\
    \end{pmatrix}
    , \quad
    \lambda \cdot \mathbf{E} = \begin{pmatrix}
        \lambda&0&\ldots &0\\
        0&\lambda&\ldots&0\\
        \vdots &\vdots &\ddots &\vdots \\
        0&0&\ldots&\lambda\\
    \end{pmatrix}$

    \medskip
    $\mathbf{H}(x_0,y_0,\ldots t_0) - \lambda \cdot \mathbf{E} = \ldots \\
    \ldots  = 
    \begin{pmatrix}
        f_{xx}(x_0,y_0,\ldots t_0)- \lambda&f_{xy}(x_0,y_0, \ldots t_0)&\cdots &f_{xt}(x_0,y_0,\ldots t_0)\\
        f_{yx}(x_0,y_0,\ldots t_0)&f_{yy}(x_0,y_0, \ldots t_0)- \lambda&\cdots &f_{yt}(x_0,y_0,\ldots t_0)\\
        \vdots &\vdots &\ddots &\vdots \\
        f_{tx}(x_0,y_0,\ldots t_0)&f_{ty}(x_0,y_0, \ldots t_0)&\cdots &f_{tt}(x_0,y_0,\ldots t_0)- \lambda\end{pmatrix}$

    \item \textbf{Auswertung:}
    
    \begin{tabular}{lll}
        \hline
        $\lambda_i < 0 \,\,\,\forall i$ &$\Longrightarrow$& $\text{lokales Maximum}$\\
        \hline
        $\lambda_i > 0 \,\,\,\forall i$ &$\Longrightarrow$& $\text{lokales Minimum}$\\
        \hline
        $\lambda_i > 0\,$ und $\,\lambda_i < 0$ &$\Longrightarrow$& $\text{Sattelpunkt}$\\
        \hline
    \end{tabular}

    \medskip
    Erklärung:
    \begin{itemize}
        \item $\lambda_i < 0 \,\,\,\forall i$ $\Leftrightarrow $ Alle $\lambda_i$ sind negativ
        \item $\lambda_i > 0 \,\,\,\forall i$ $\Leftrightarrow $ Alle $\lambda_i$ sind positiv
    \end{itemize}
\end{enumerate}


\subsection{Lokales oder Globales Extremum}
Für eine beliebige die Funktion $f(x, y, \ldots  , t)$ gilt:

$\boxed{\begin{array}{llll}
    f(x,y,\ldots ,t)\leq M_{\max}&\forall(x,y,\ldots ,t)\in\mathbb{D}_f&\Rightarrow&\text{globales Maxinum}\\
    f(x,y,\ldots ,t)>M_{\max}&\exists(x,y,\ldots ,t)\in\mathbb{D}_f&\Rightarrow&\text{kein globales Maximum}\\
    \hline f(x,y,\ldots ,t)\geq M_{\min}&\forall(x,y,\ldots ,t)\in\mathbb{D}_f&\Rightarrow&\text{globales Minimum}\\
    f(x,y,\ldots ,t)<M_{\min}&\exists(x,y,\ldots ,t)\in\mathbb{D}_f&\Rightarrow&\text{kein globales Minimum}
\end{array}}$

\medskip
\begin{tabular}{ll}
    $M_{\max}$: &\text{grösstes lokales Maximum}\\
    $M_{\min}$: &\text{kleinstes lokales Minimum}
\end{tabular}




\subsection{Extrema von Funktionen zweier Variablen mit NB finden}

\begin{enumerate}[itemsep=1ex]
    \item \textbf{Nebenbedingung (NB) in Standardform bringen:}\\
    \begin{minipage}[t]{0.4\linewidth}
        Standardform: $n(x, y) \stackrel{!}{=} 0$
    \end{minipage}\hfill
    \begin{minipage}[t]{0.58\linewidth}
            \textcolor{gray}{Nebenbedingung: $x + y = 1$}\\
            \textcolor{gray}{Standardform der Nebenbedingung: $x + y - 1 = 0$}
    \end{minipage}


    \item \textbf{Lagrange-Funktion $\mathrm{L}$ aufstellen:}\\
    $\mathrm{L}(x, y, \lambda) =
    f(x, y) + \lambda \cdot n(x, y) \,\,\,\,\,\,$ \textcolor{gray}{Am besten gleich ausmultiplizieren}
    

    \item \textbf{Gradient der Lagrange-Funktion $\mathrm{L}$ Null-setzten und kritische Stellen finden:}\\
    $\nabla \mathrm{L}=
    \begin{pmatrix}
        \mathrm{L}_x\\
        \mathrm{L}_y\\
        \mathrm{L}_\lambda
    \end{pmatrix} \stackrel{!}{=}
    \begin{pmatrix}
        0\\
        0\\
        0
    \end{pmatrix}
    \, \, \, \, \, \,
    \Rightarrow 
    x_0 \text{ und } y_0 \text{ bestimmen}$
    \hfill

    \item \textbf{Zweite Partielle Ableitungen bestimmen:}\\
    \begin{minipage}[t]{0.4\linewidth}
        $\begin{aligned}
            \mathrm{L}_{\lambda \lambda} &\stackrel{!}{=} 0\\
            \mathrm{L}_{xx} &= \dots\\
            \mathrm{L}_{yy} &= \dots\\
        \end{aligned}$
    \end{minipage}\hfill
    \begin{minipage}[c]{0.58\linewidth}
        $\begin{aligned}
            \mathrm{L}_{\lambda x} &= \mathrm{L}_{x\lambda} = n_x = \dots\\
            \mathrm{L}_{\lambda y} &= \mathrm{L}_{y\lambda} = n_y =\dots\\
            \mathrm{L}_{xy} &= \mathrm{L}_{yx} = \dots\\
        \end{aligned}$
    \end{minipage}


    \item \textbf{Geränderte Hesse Matrix $\overline{\mathbf{H}}$ aufstellen und kritische Stellen einsetzen:}
    
    \begin{tabular}{lll}
        $\overline{\mathbf{H}}(x_0,y_0)$ &$=$&
        $\left(
            \begin{matrix}
                {{\mathrm{L}_{\lambda\lambda}(x_0, y_0)}}&{{\mathrm{L}_{\lambda x}(x_0, y_0)}}&{{\mathrm{L}_{\lambda y}(x_0, y_0)}}\\
                {{\mathrm{L}_{x\lambda}(x_0, y_0)}}&{{\mathrm{L}_{xx}(x_0, y_0)}}&{{\mathrm{L}_{xy}(x_0, y_0)}}\\
                {{\mathrm{L}_{y\lambda}(x_0, y_0)}}&{{\mathrm{L}_{yx}(x_0, y_0)}}&{{\mathrm{L}_{yy}(x_0, y_0)}}\\
            \end{matrix}
        \right)$\\
        &$=$&
        $\left(
            \begin{matrix}
                {{0}}&{{n_{x}(x_0, y_0)}}&{{n_{y}(x_0, y_0)}}\\
                {{n_{x}(x_0, y_0)}}&{{\mathrm{L}_{xx}(x_0, y_0)}}&{{\mathrm{L}_{xy}(x_0, y_0)}}\\
                {{n_{y}(x_0, y_0)}}&{{\mathrm{L}_{yx}(x_0, y_0)}}&{{\mathrm{L}_{yy}(x_0, y_0)}}\\
            \end{matrix}
        \right)$
        
    \end{tabular}


    \item \textbf{Determinante der geränderten Hesse Matrix bestimmen:}\\
    $\text{det}\left(\overline{\mathbf{H}}\right) = ... $

    \item \textbf{Auswertung}\\
    \begin{tabular}{lll}
        \hline
        $\text{det}\left(\overline{\mathbf{H}}\right) > 0$ &$\Longrightarrow$& $\text{lokales Maximum}$\\
        \hline
        $\text{det}\left(\overline{\mathbf{H}}\right) < 0$ &$\Longrightarrow$& $\text{lokales Minimum}$\\
        \hline
        $\text{det}\left(\overline{\mathbf{H}}\right) = 0$ &$\Longrightarrow$& $\text{keine Aussage möglich}$\\
        \hline
    \end{tabular}

\end{enumerate}

\subsection{Extrema von Funktionen mehrerer Variablen mit NB finden}

\begin{enumerate}[itemsep=1ex]
    \item \textbf{Nebenbedingung (NB) in Standardform bringen:}\\
    \begin{minipage}[t]{0.4\columnwidth}
        Standardform: $n(x, y, ... , t) \stackrel{!}{=} 0$
    \end{minipage}\hfill
    \begin{minipage}[t]{0.6\columnwidth}
    \end{minipage}


    \item \textbf{Lagrange-Funktion $\mathrm{L}$ aufstellen:}\\
    $\mathrm{L}(x, y, ..., t, \lambda) =
    f(x, y, ..., t) + \lambda \cdot n(x, y, ..., t) \,\,\,\,\,\,$ \textcolor{gray}{Am besten gleich ausmultiplizieren}
    

    \item \textbf{Gradient der Lagrange-Funktion $\mathrm{L}$ Null-setzten und kritische Stellen finden:}
    $\nabla \mathrm{L}=
    \begin{pmatrix}
        \mathrm{L}_x\\
        \mathrm{L}_y\\
        \vdots \\
        \mathrm{L}_t\\
        \mathrm{L}_\lambda
    \end{pmatrix} \stackrel{!}{=}
    \begin{pmatrix}
        0\\
        0\\
        \vdots \\
        0\\
        0
    \end{pmatrix}
    \, \, \, \, \, \,
    \Rightarrow 
    x_0 \text{, } y_0 \text{, }... \text{, } t_0 \text{ bestimmen}$
    \hfill

    \item \textbf{Zweite Partielle Ableitungen bestimmen:}
    

    \begin{tabular}{lllll}
        $\begin{matrix}
        \mathrm{L}_{\lambda \lambda} \stackrel{!}{=} 0\\
        \mathrm{L}_{xx} = \dots\\
        \mathrm{L}_{yy} = \dots\\
        \vdots \\
        \mathrm{L}_{tt} = \dots\\
        \end{matrix}$
        &$\,\,\,\,\,\,\,\,$&
        $\begin{matrix}
        \mathrm{L}_{\lambda x} = \mathrm{L}_{x\lambda} = n_x = \dots\\
        \mathrm{L}_{\lambda y} = \mathrm{L}_{y\lambda} = n_y =\dots\\
        \vdots \\
        \mathrm{L}_{\lambda t} = \mathrm{L}_{t\lambda} = n_t =\dots\\
        \end{matrix}$
        &$\,\,\,\,\,\,\,\,$&
        $\begin{matrix}
        \mathrm{L}_{xy} = \mathrm{L}_{yx}\\
        \mathrm{L}_{xt} = \mathrm{L}_{tx}\\
        \mathrm{L}_{yt} = \mathrm{L}_{ty}\\
        \vdots \\
        \end{matrix}$
    \end{tabular}

    \item \textbf{Geränderte Hesse Matrix $\overline{\mathbf{H}}$ aufstellen und kritische Stellen einsetzen:}\\
    \begin{tabular}{lll}
        $\overline{\mathbf{H}}(\crd{x_0,y_0,\ldots t_0})$ &$=$&
        $\left(
            \begin{matrix}
                {{\mathrm{L}_{\lambda\lambda}(\crd{...})}}&{{\mathrm{L}_{\lambda x}(\crd{...})}}&{{\mathrm{L}_{\lambda y}(\crd{...})}}&{\cdots }&{{\mathrm{L}_{\lambda t}(\crd{...})}}\\
                {{\mathrm{L}_{x\lambda}(\crd{...})}}&{{\mathrm{L}_{xx}(\crd{...})}}&{{\mathrm{L}_{xy}(\crd{...})}}&{\cdots }&{{\mathrm{L}_{xt}(\crd{...})}}\\
                {{\mathrm{L}_{y\lambda}(\crd{...})}}&{{\mathrm{L}_{yx}(\crd{...})}}&{{\mathrm{L}_{yy}(\crd{...})}}&{\cdots }&{{\mathrm{L}_{yt}(\crd{...})}}\\
                {\vdots }&{\vdots }&{\vdots }&{\ddots }&{\vdots }\\
                {{\mathrm{L}_{t\lambda}(\crd{...})}}&{{\mathrm{L}_{tx}(\crd{...})}}&{{\mathrm{L}_{ty}(\crd{...})}}&{\cdots }&{{\mathrm{L}_{tt}(\crd{...})}}\\
            \end{matrix}
        \right)$\\
        &$=$&
        $\left(
            \begin{matrix}
                {{0}}&{{n_{x}(\crd{...})}}&{{n_{y}(\crd{...})}}&{\cdots }&{{n_{t}(\crd{...})}}\\
                {{n_{x}(\crd{...})}}&{{\mathrm{L}_{xx}(\crd{...})}}&{{\mathrm{L}_{\lambda y}(\crd{...})}}&{\cdots }&{{\mathrm{L}_{xt}(\crd{...})}}\\
                {{n_{y}(\crd{...})}}&{{\mathrm{L}_{yx}(\crd{...})}}&{{\mathrm{L}_{yy}(\crd{...})}}&{\cdots }&{{\mathrm{L}_{yt}(\crd{...})}}\\
                {\vdots }&{\vdots }&{\vdots }&{\ddots }&{\vdots }\\
                {{n_{t}(\crd{...})}}&{{\mathrm{L}_{tx}(\crd{...})}}&{{\mathrm{L}_{ty}(\crd{...})}}&{\cdots }&{{\mathrm{L}_{tt}(\crd{...})}}\\
            \end{matrix}
        \right)$
    \end{tabular}

    \item \textbf{Determinante der geränderten Hesse Matrix bestimmen:}\\
    $\text{det}\left(\overline{\mathbf{H}}\right) = ... $

    \item \textbf{Auswertung}\\
    \begin{tabular}{lll}
        \hline
        $\text{det}\left(\overline{\mathbf{H}}\right) > 0$ &$\Longrightarrow$& $\text{lokales Maximum}$\\
        \hline
        $\text{det}\left(\overline{\mathbf{H}}\right) < 0$ &$\Longrightarrow$& $\text{lokales Minimum}$\\
        \hline
        $\text{det}\left(\overline{\mathbf{H}}\right) = 0$ &$\Longrightarrow$& $\text{keine Aussage möglich}$\\
        \hline
    \end{tabular}

\end{enumerate}

\subsection{Weiszfeld-Iteration}
Der Weiszfeld-Algorithmus ist ein iteratives Verfahren zur Berechnung des
geometrischen Medians eines Punktemenge im $\mathbb{R}^m$. Der geometrische
Median ist der Punkt $\vec{x}$ der die Summe der gewichteten euklidischen Abstände
zu gegebenen Punkten $\vec{p}_j$ minimiert:
\begin{center}
    \boxed{ f(\vec{x}) = \sum_{j=1}^{N} r_j w_j = \sum_{j=1}^{N} \parallel \vec{x} - \vec{p}_j \parallel w_j \rightarrow min! }
\end{center}
\vspace{0.1cm}
Dabei ist $r_j = \parallel \vec{x} - \vec{p}_j \parallel$ der euklidische Abstand und $w_j \geq 0$ das \textbf{Gewicht} des Punktes $\vec{p}_j$.

\vspace{0.1cm}
Statt die Minimumsbedingung direkt zu lösen, nutzt man die stationäre Bedingung:
\vspace{0.1cm}

\begin{center}
    $\boxed{ \sum_{j = 1}^{N} \frac{\vec{x}-\vec{p}_j}{\parallel \vec{x} - \vec{p}_j \parallel}w_j = \vec{0} }
    \Leftrightarrow \boxed{\vec{x}^{\, (k+1)} = \frac{\sum_{j = 1}^{N} \frac{w_j}{\parallel \vec{x}^{\, (k)} - \vec{p}_j \parallel} \vec{p}_j}{\sum_{j = 1}^{N} \frac{w_j}{\parallel \vec{x}^{\, (k)} - \vec{p}_j \parallel}}}$
\end{center}

Im oberen Schritt sieht man die Umformung von der stationären Bedingung zur Weiszfeld-Iteration. $\vec{x}^{\,(k)}$ sei
der aktuelle Schätzwert. $\vec{x}^{\,(k + 1)}$ ist der folgende Schätzwert.
