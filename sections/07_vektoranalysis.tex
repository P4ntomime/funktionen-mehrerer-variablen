\section{Vektoranalysis}

\subsection{Vektorfelder}
Das Vektorfeld \[\vec{V}:\mathbb{R}^n \rightarrow \mathbb{R}^n\] weist jedem Punkt $P \in \mathbb{R}^n$ einen Vektor $\vec{v} \in \mathbb{R}^n$ zu.
Die Notation eines Vektorfelds ist gleich deren eines Vektors, wobei Vektorfelder üblicherweise gross geschrieben werden.
Weiter kann auch $\vec{V}(\vec{x})$ geschrieben werden, wobei $\vec{x}$ der Stützvektor eines beliebigen Punktes ist.

\subsection{Gradient}
Wir erinnern uns an den Nabla- oder Del-Operator aus Kapitel \ref{section:diff_dgl_gradient_bivar:gradient} als Spaltenvektor der verschiedenen Raumableitungen:
\[
    \nabla 
    = \begin{pmatrix} \frac{\partial}{\partial x_1} & \frac{\partial}{\partial x_2} & \dots & \frac{\partial}{\partial x_n} \end{pmatrix}^T
\]
Der Gradient eines Potentialfelds $\phi: \mathbb{R}^n \to \mathbb{R}$ berechnet sich als 
\[
    \nabla \cdot \phi(\vec{x}) 
    = \begin{pmatrix} \frac{\partial}{\partial x_1} & \frac{\partial}{\partial x_2} & \dots & \frac{\partial}{\partial x_n} \end{pmatrix}^T \cdot \phi(\vec{x}) 
    = \begin{pmatrix} \frac{\partial \phi}{\partial x_1}(\vec{x}) & \frac{\partial \phi}{\partial x_2}(\vec{x}) & \dots & \frac{\partial \phi}{\partial x_n}(\vec{x}) \end{pmatrix}^T 
    = \vec{F}(\vec{x})
\]
und resultiert in einem Vektorfeld.
\begin{itemize}
    \item Wird als Potential das elektrische Potential verwendet, entspricht $\vec{F}$ dem (negativen, skalierten) elektrischen Feld.
    \item Wird als Potential eine Höhe verwendet, entspricht $\vec{F}$ der negativen Hangabtriebskraft.
    \item Der Gradient kann als mehrdimensionale Ableitung verstanden werden.
    \item Der Gradient steht senkrecht auf allen Kontouren unz zeigt in Richtung hoher wert.
    \item Die Multiplikation $\nabla \cdot \phi$ wird normalerweise als $\nabla \phi$ abgekürzt.
    \item Zudem kann der Gradient auch als $\grad \phi$ geschrieben werden.
\end{itemize}

\subsubsection{Verschiedene Koordinatensysteme}
\myul{\textbf{Kartesisch:}}
\[
    \boxed{
        \grad V
        = \nabla V
        = \begin{pmatrix}
            \frac{\partial V}{\partial x}\\
            \frac{\partial V}{\partial y}\\
            \frac{\partial V}{\partial z}\\
        \end{pmatrix}
    }
\]

\myul{\textbf{Zylindrisch:}}
\[
    \boxed{
        \grad V
        = \nabla V
        = \begin{pmatrix}
            \frac{\partial V}{\partial r}\\
            \frac{1}{r} \frac{\partial V}{\partial \varphi}\\
            \frac{\partial V}{\partial z}\\
        \end{pmatrix}
    }
\]

\myul{\textbf{Sphärisch:}}
\[
    \boxed{
        \grad V
        = \nabla V
        = \begin{pmatrix}
            \frac{\partial V}{\partial r}\\
            \frac{1}{r} \frac{\partial V}{\partial \theta}\\
            \frac{1}{r \sin \theta} \frac{\partial V}{\partial \phi}\\
        \end{pmatrix}
    }
\]

\subsection{Vektorgradient}
Die Definition des Gradienten eines Vektorfeldes $\vec{V}: \mathbb{R}^n \to \mathbb{R}^m$ lautet
\[ \frac{\partial \vec{V}}{\partial \vec{a}} = \vec{a} \dotp \grad \vec{V}, \]
wobei $\vec{a}$ ein beliebiger Vektor und $\frac{\partial \vec{V}}{\partial \vec{a}}$ die Richtungsableitung von $\vec{V}$ nach $\vec{a}$ ist.
Daraus kann man schliessen, dass der Vektorgradient als
\[ 
    \grad \vec{V} 
    = \nabla \vec{V}
    = \begin{pmatrix}
        \frac{\partial V_1}{\partial x_1} & \hdots & \frac{\partial V_1}{\partial x_n} \\
        \vdots & \ddots & \vdots \\
        \frac{\partial V_m}{\partial x_1} & \hdots & \frac{\partial V_m}{\partial x_n} \\
    \end{pmatrix} 
    = \mathbf{J}
    \hspace{1em} \left(= \nabla^T \dotp \vec{V}\right)
\]
berechnet werden kann.
\begin{itemize}
    \item $\nabla \vec{V}$ entspricht der Jacobi-Matrix $\mathbf{J}$. 
          Mit dieser kann die Hesse-Matrix einer skalaren Funktion $F$ (siehe Kap. \ref{section:extrema_bivar}) bestimmt werden: \[ \mathbf{H}(F) = \mathbf{J}^T(\nabla F) = (\grad \grad F)^T \]
    \item Der Vektorgradient wird als $\nabla \vec{V}$ geschrieben, da die Notation $\nabla^T \dotp \vec{V}$, die den tatsächlichen Rechenweg beschreibt, etwas umständlich ist.
    \item Die Notation $\nabla \dotp \vec{V}$ ist nicht nur falsch, sondern zudem bereits durch die Divergenz besetzt.
\end{itemize}

\subsection{Divergenz (Volumenableitung)}
Die Divergenz oder Volumenableitung eines Vektorfelds
\[
\begin{aligned}
    \nabla \dotp \vec{V}(\vec{x})
    &= \begin{pmatrix} \frac{\partial}{\partial x_1} & \frac{\partial}{\partial x_2} & \dots & \frac{\partial}{\partial x_n} \end{pmatrix}^T \dotp \begin{pmatrix} v_1(\vec{x}) & v_2(\vec{x}) & \dots & v_n(\vec{x}) \end{pmatrix}^T \\
    &= \frac{\partial v_1}{\partial x_1}(\vec{x}) + \frac{\partial v_2}{\partial x_2}(\vec{x}) + \dots + \frac{\partial v_n}{\partial x_n}(\vec{x})
\end{aligned}
\]
ist ein Skalarfeld, das beschreibt, wie stark das Vektorfeld an einem gegebenen Punkt ``nach aussen gerichtet'' ist. 

\medskip
\begin{outline}
    \1 Wird als Vektorfeld die Fliessgeschwindigkeit einer Flüssigkeit eingesetzt, so entspricht die Divergenz dem Fluss aus einem Punkt heraus.
        \2 An Punkten mit positiver Divergenz fliesst Flüssigkeit hinaus (Quelle)
        \2 An Punkten mit negativer Divergenz fliesst Flüssigkeit hinein (Senke)
    \1 Wird das E-Feld eingesetzt, so entspricht die Divergenz der Ladungsdichte.
        \2 Pos. Ladungsdichte entspricht pos. Divergenz, bewirkt eine Quelle im E-Feld.
        \2 Neg. Ladungsdichte entspricht neg. Divergenz, bewirkt eine Senke im E-Feld.
    \1 Das Skalarprodukt sollte zwingend $\nabla \dotp \vec{V}$ ausgschreiben werden, da sonst Verwechslungsgefahr mit dem Vektorgradienten besteht.
    \1 Die Notation $ \div \vec{V}$ ist ebenfalls gebräuchlich.
\end{outline}

\medskip
Eine alternative und gut visualisierbare Definition der Divergenz, ist in zwei dimensionen
\[
    \div \vec{V} = \nabla\dotp\vec{V}  = \lim_{A \to 0}\frac{\oint\limits_{C = \partial A} \vec{V} \dotp \hat{n} \diff s}{A},
\]
wobei $A$ eine Fläche mit den Normalen $\hat{n}$ und $C$ dessen Kontur darstellt.

Verallgemeinert für die Anwendung in mehr als 2 Dimensionen lautet die Definition
\[
    \nabla\dotp\vec{V} = \div \vec{V} = \lim_{\Omega \to 0}\frac{\oint\limits_{C = \partial \Omega}\vec{V} \dotp \hat{n} \diff s}{\Omega},
\]
wobei $\Omega$ ein Bereich im Raum $\mathbb{R}^n$ und C dessen Kontur in $\mathbb{R}^{n-1}$ ist.

\subsubsection{Verschiedene Koordinatensysteme}
\myul{\textbf{Kartesisch:}}
\[
    \boxed{
        \div \vec{V}
        = \nabla \dotp \vec{V}
        = \frac{\partial V_x}{\partial x} + \frac{\partial V_y}{\partial y} + \frac{\partial V_z}{\partial z}
    }
\]

\myul{\textbf{Zylindrisch:}}
\[
    \boxed{
        \div \vec{V}
        = \nabla \dotp \vec{V}
        = \frac{1}{r} \frac{\partial (r \cdot V_r)}{\partial r} + \frac{1}{r} \frac{\partial V_\varphi}{\partial \varphi} + \frac{\partial V_z}{\partial z}
    }
\]

\myul{\textbf{Sphärisch:}}
\[
    \boxed{
        \div \vec{V}
        = \nabla \dotp \vec{V}
        = \frac{1}{r^2} \frac{\partial (r^2 \cdot V_r)}{\partial r} + \frac{1}{r \sin \theta} \frac{\partial (\sin \theta \cdot V_\theta)}{\partial \theta} + \frac{1}{r \sin \theta} \frac{\partial V_\phi}{\partial \phi}
    }
\]


\subsection[Laplace Operator Delta]{Laplace Operator $\Delta$}
Der Laplaceoperator ist nichts anderes als die Divergenz des Gradienten eines Skalarfelds und vergleichbar mit der zweiten Ableitung.
Folglich gilt
\[
    \Delta V(x_1 \dots x_n) 
    = \nabla \dotp (\nabla V(x_1 \dots x_n)) 
    = \nabla^2 V(x_1 \dots x_n) 
    = \frac{\partial^2 V}{\partial x_1^2} + \frac{\partial^2 V}{\partial x_2^2} + \dots + \frac{\partial^2 V}{\partial x_n^2},
\]
wobei das Resultat ein Skalarfeld ist.

\subsubsection{Verschiedene Koordinatensysteme}
\myul{\textbf{Kartesisch:}}
\[
    \boxed{
        \Delta V(x, y, z)
        = \frac{\partial^2 V}{\partial x^2} 
        + \frac{\partial^2 V}{\partial y^2} 
        + \frac{\partial^2 V}{\partial z^2}
    }
\]

\myul{\textbf{Zylindrisch:}}
\[
    \boxed{
        \Delta V(r, \varphi, z) 
        = \frac{1}{r}\frac{\partial}{\partial r}\left\lgroup r\frac{\partial V}{\partial r} \right\rgroup 
        + \frac{1}{r^2}\frac{\partial^2 V}{\partial \varphi^2} 
        + \frac{\partial^2 V}{\partial z^2}
    }
\]

\myul{\textbf{Sphärisch:}}
\[
    \boxed{
        \Delta V(r, \theta, \phi)=
        \frac{1}{r^2}\frac{\partial}{\partial r}\left\lgroup r^2 \frac{\partial V}{\partial r} \right\rgroup 
        + \frac{1}{r^2\sin\theta}\frac{\partial}{\partial\theta}\left\lgroup \sin\theta \frac{\partial V}{\partial\theta} \right\rgroup 
        + \frac{1}{r^2\sin^2\theta}\frac{\partial^2 V}{\partial\phi^2}
 }
\]


\subsection[Rotation eines Vektorfelds (rot, curl)]{Rotation eines Vektorfelds ($\rot$, $\curl$)}
Die Rotation eines Vektorfelds, auch Curl genannt, beschreibt, wie stark ein Vektorfeld um einen gegebenen Punkt ``rotiert'' und wird als

\begin{minipage}{0.8\linewidth}
    \[
        \rot \vec{V}
        = \nabla \times \vec{V}
        =   \begin{pmatrix}
                \frac{\partial}{\partial x}\\
                \frac{\partial}{\partial y}\\
                \frac{\partial}{\partial z}
            \end{pmatrix} \times 
        \begin{pmatrix}
            V_x \\ V_y \\ V_z
        \end{pmatrix} =
        \begin{pmatrix}
            \frac{\partial V_z}{\partial y} - \frac{\partial V_y}{\partial z}\\
            \frac{\partial V_x}{\partial z} - \frac{\partial V_z}{\partial x}\\
            \frac{\partial V_y}{\partial x} - \frac{\partial V_x}{\partial y}
        \end{pmatrix}
    \]
\end{minipage}
\hfill
\begin{minipage}{0.19\linewidth}
    \begin{center}
        \tdplotsetmaincoords{70}{110}
        \begin{tikzpicture}[tdplot_main_coords, scale=1]
            % Ebene
            \foreach \x in {-0.75,-0.5,...,0.75}
            {
                \draw[gray,very thin] (\x, -0.75, 0) -- (\x, 0.75, 0);
                \draw[gray,very thin] (-0.75, \x, 0) -- (0.75, \x, 0);
            }
            
            % Curl Vektor
            \draw [-{latex}] (0, 0, 0) -- (0, 0, 1) node [right] {$\nabla \times \vec{V}$};

            % Rechte Winkel
            \tdplotsetrotatedcoords{0}{90}{0}
            \draw[tdplot_rotated_coords, gray, very thin] (0, 0.15, 0) arc (90:180:0.15);
            \fill[tdplot_rotated_coords, gray] (-0.05, 0.04, 0) arc (-90:270:0.02);
            \tdplotsetrotatedcoords{-90}{90}{0}
            \draw[tdplot_rotated_coords, gray, very thin] (0, 0.15, 0) arc (90:180:0.15);
            \fill[tdplot_rotated_coords, gray] (-0.05, 0.04, 0) arc (-90:270:0.02);

            % Vektorfeld
            \draw [-{latex}] (0.5,0,0) arc (0:360:0.5) node [pos=0.7, above left, fill=white, rounded corners, inner sep=1pt] {$\vec{V}$};
        \end{tikzpicture}
    \end{center}
\end{minipage}
berechnet.
Der resultierende Vektor ist dabei die Rotationsachse, wobei die Rechte-Hand-Regel gilt.

Wie bei der Divergenz kann auch hier zur Hilfe der Verständlichkeit ein Limitsatz als Definition beigezogen werden.
So sei
\[
    \nabla\times\vec{V} = \rot \vec{V} = \hat{n} \lim_{S \to 0}\frac{\oint\limits_{C = \partial S}\vec{V} \dotp \diff \vec{l}}{S},
\]
wobei $S$ ein planare Testfläche mit normale $\hat{n}$ und C dessen Kontur ist. 


Der Curl ist grundsätzlich nur in drei Raumdimensionen definiert.
Wenn die Rotation eines auf der Ebene $z=0$ definierten Vektorfelds berechnet werden soll, kann die obige Formel mit $V_z = 0$ angepasst werden:
\[
    \rot \vec{V}(x, y)
    = \nabla \times \vec{V}(x, y)
    =   \begin{pmatrix}
            \frac{\partial}{\partial x}\\
            \frac{\partial}{\partial y}\\
            \frac{\partial}{\partial z}
        \end{pmatrix} \times 
    \begin{pmatrix}
        V_x \\ V_y \\ 0
    \end{pmatrix} =
    \begin{pmatrix}
        0 \\
        0 \\
        \frac{\partial V_y}{\partial x} - \frac{\partial V_x}{\partial y}
    \end{pmatrix}
\]

\begin{outline}
    \1 Mit dem Curl-Operator kann z.B. elegant beschrieben werden, dass Wirbel im E-Feld auf zeitliche Änderungen im magnetischen Feld zurückzuführen sind:
        \2[] $\nabla \times \vec{E} = -\frac{\partial \vec{H}}{\partial t}$
\end{outline}


\subsubsection{Verschiedene Koordinatensysteme}
\myul{\textbf{Kartesisch:}}
\[
    \boxed{
        \rot \vec{V}
        = \nabla \times \vec{V}
        = \begin{pmatrix}
            \frac{\partial V_z}{\partial y} - \frac{\partial V_y}{\partial z}\\
            \frac{\partial V_x}{\partial z} - \frac{\partial V_z}{\partial x}\\
            \frac{\partial V_y}{\partial x} - \frac{\partial V_x}{\partial y}\\
        \end{pmatrix}
    }
\]

\myul{\textbf{Zylindrisch:}}
\[
    \boxed{
        \rot \vec{V}
        = \nabla \times \vec{V}
        = \begin{pmatrix}
            \frac{1}{r}\frac{\partial V_z}{\partial \phi} - \frac{\partial V_\phi}{\partial z}\\
            \frac{\partial V_r}{\partial z} - \frac{\partial V_z}{\partial r}\\
            \frac{1}{r} \left(\frac{\partial (r \cdot V_\phi)}{\partial r} - \frac{\partial V_r}{\partial \phi}\right)\\
        \end{pmatrix}
    }
\]

\myul{\textbf{Sphärisch:}}
\[
    \boxed{
        \rot \vec{V}
        = \nabla \times \vec{V}
        = \begin{pmatrix}
            \frac{1}{r \sin \theta} \left(\frac{\partial (V_\phi \cdot \sin \theta)}{\partial \theta} - \frac{\partial V_\theta}{\partial \phi}\right)\\
            \frac{1}{r} \left(\frac{1}{\sin \theta} \frac{\partial V_r}{\partial \phi} - \frac{\partial (r \cdot V_\phi)}{\partial r}\right)\\
            \frac{1}{r} \left(\frac{\partial (r \cdot V_\theta)}{\partial r} - \frac{\partial V_r}{\partial \theta}\right)\\
        \end{pmatrix}
    }
\]


\subsection[Rechenregeln mit Nabla]{Rechenregeln mit $\nabla$}
Für das dalegen der Rechenregeln werden die folgenden Platzhalter verwendet:
\begin{center}\begin{tabular}[]{r l}
    $A, B$: & Skalarfelder ($\mathbb{R}^n \to \mathbb{R}$) \\
    $\vec{A}, \vec{B}$: & Vektorfelder ($\mathbb{R}^n \to \mathbb{R}^n$) \\
    $F$: & Skalare Funktion ($\mathbb{R}^n \to \mathbb{R}$) \\
    $c$: & Konstante \\
\end{tabular}\end{center}

\myul{Gradienten:}
\begin{center}
    \begin{tabular}[]{r c l}
        $ \grad(A+B) = \grad(A) + \grad (B) $ & $\leftrightarrow$ & $ \nabla (A + B) = \nabla A + \nabla B $ \\
        $ \grad(A \cdot B) = A \grad(B) + B \grad (A) $ & $\leftrightarrow$ & $ \nabla (A \cdot B) = A \cdot \nabla B + B \cdot \nabla A $ \\
        $ \grad(c \cdot A) = c \grad(A) $ & $\leftrightarrow$ & $ \nabla (c \cdot A) = c \cdot \nabla A $ \\
        $ \grad(F(A)) = F'(A) \cdot \grad A $ & $\leftrightarrow$ & $ \nabla F(A) = F'(A) \cdot \nabla A $ \\
    \end{tabular}
\end{center}

\myul{Divergenzen:}
\begin{center}
    \begin{tabular}[]{r c l}
        $ \div(\vec{A}+\vec{B}) = \div (\vec{A}) + \div (\vec{B}) $ & $\leftrightarrow$ & $ \nabla \dotp (\vec{A} + \vec{B}) = (\nabla \dotp \vec{A}) + (\nabla \dotp \vec{B}) $ \\
        $ \div(A \cdot \vec{B}) = A \div (\vec{B}) + \vec{B} \grad (A) $ & $\leftrightarrow$ & $ \nabla \dotp (A \cdot \vec{B}) = A \cdot (\nabla \dotp \vec{B}) + \vec{B} \dotp \nabla A $ \\
        $ \div(\vec{A} \times \vec{B}) = \vec{B} \dotp \rot (\vec{A}) - \vec{A} \dotp \rot(\vec{B}) $ & $\leftrightarrow$ & $ \nabla \dotp (\vec{A} \times \vec{B}) = \vec{B} \dotp (\nabla \times \vec{A}) - \vec{A} \dotp (\nabla \times \vec{B}) $ \\
        $ \div(c \cdot \vec{A}) = c \div(\vec{A}) $ & $\leftrightarrow$ & $ \nabla \dotp (c \cdot \vec{A}) = c \cdot (\nabla \dotp \vec{A}) $ \\
    \end{tabular}
\end{center}

\myul{Curl:}
\begin{center}
    \begin{tabular}[]{r c l}
        $ \rot(\vec{A}+\vec{B}) = \rot (\vec{A}) + \rot (\vec{B}) $ & $\leftrightarrow$ & $ \nabla \times (\vec{A} + \vec{B}) = (\nabla \times \vec{A}) + (\nabla \times \vec{B}) $ \\
        $ \rot(A \cdot \vec{B}) = A \rot (\vec{B}) + (\grad (A) \times \vec{B}) $ & $\leftrightarrow$ & $ \nabla \times (A \cdot \vec{B}) = A \cdot (\nabla \times \vec{B}) + (\nabla A \times \vec{B}) $ \\
        $ \rot(c\vec{A}) = c \rot(\vec{A}) $ & $\leftrightarrow$ & $ \nabla \times (c \vec{A}) = c \cdot (\nabla \times \vec{A}) $ \\
        % TODO: This ist not verry pretty but works to get the point accross...
        \multicolumn{3}{l}{ $ \rot(\vec{A} \times \vec{B}) = (\vec{B} \dotp \nabla) \vec{A} - (\vec{A} \dotp \nabla) \vec{B} + \vec{A} \div \vec{B} - \vec{B} \div \vec{A}$ } \\
        \multicolumn{3}{c}{ \rotatebox{135}{$\leftrightarrow$} } \\
        \multicolumn{3}{r}{ $ \nabla \times (\vec{A} \times \vec{B}) = (\vec{B} \dotp \nabla) \vec{A} - (\vec{A} \dotp \nabla) \vec{B} + \vec{A} (\nabla \dotp \vec{B}) - \vec{B} (\nabla \dotp \vec{A}) $ } \\
    \end{tabular}
\end{center}

\myul{Laplaceoperator:}
\begin{center}
    \begin{tabular}[]{r c l}
        $ \div \grad A = \Delta A $ & $\leftrightarrow$ & $ \nabla \dotp (\nabla A) = \Delta A $ \\
        $ \rot (\Delta \vec{A}) = \Delta \rot \vec{A} $ & $\leftrightarrow$ & $ \nabla \times (\Delta \vec{A}) = \Delta (\nabla \times \vec{A}) $ \\
    \end{tabular}
\end{center}

\myul{Kombinationen:}
\begin{center}
    \begin{tabular}[]{r c l}
        $ \div \rot \vec{A} = 0 $ & $\leftrightarrow$ & $ \nabla \dotp (\nabla \times \vec{A}) = 0 $ \\
        $ \div \grad A = \Delta A $ & $\leftrightarrow$ & $\nabla \dotp \nabla A = \Delta A $ \\
        $ \rot \grad \vec{A} = \vec{0} $ & $\leftrightarrow$ & $ \nabla \times (\nabla A) = \vec{0} $ \\
        $ \rot \rot \vec{A} = \grad \div \vec{A} - \Delta \vec{A} $ & $\leftrightarrow$ & $\nabla \times (\nabla \times \vec{A}) = \nabla (\nabla \dotp \vec{A}) - \Delta \vec{A} $ \\
    \end{tabular}
\end{center}

% TODO: No clue how this is supposed to work... Quelle: Bronstein S. 730 Kapitel 13.2.6.2 Punkt B
% Multiplikation: Anwenden des Operators auf die einzelnen Grössen (markiert mit $\downarrow$) und summieren der Resultate:
% \[ 
%     \nabla \dotp (\vec{A}B) 
%     = \nabla \dotp (\overset{\downarrow}{\vec{A}}B) + \nabla \dotp (\vec{A}\overset{\downarrow}{B}) 
%     = (\nabla \dotp \vec{A}) B + \vec{A} \dotp (\nabla B)
%     = B \div A + \vec{A} \dotp \grad B
% \]
%
%\myul{Gradient:} (TODO: Check if this is right)
%\[ \nabla(\vec{A} \cdot \vec{B}) = (\vec{A} \cdot \nabla) \vec{B} + (\vec{B} \cdot \nabla) \vec{A} + \vec{A} \times (\nabla \times \vec{B}) + \vec{B} \times (\nabla \times \vec{A}) \]
%

